---
title: When a door closes look towards the window
layout: post
---
<h1>
    When a Door Closes, Look Towards the Window
</h1>
<section class="cel-100">
    <p>I am still working on the Discontinuity Studios website. I came across an interesting problem I worked around and would like to share. </p>
    <h2>The Problem</h2>
    <p>I want the background graphic behind everything to change each time the page loads and fade in smoothly.</p>
    <h2>The First Solution</h2>
    <p>The first solution I came up with involved setting the body element up with a background.</p>
    <pre>
        <code>body {
background-image: url('/img/backgrounds/1.png');
}</code>
</pre>
    <p>I tend to solve problems by breaking them up into little steps so I built the step that forces a random graphic change each time the page loads first. I set it up beforehand with some indexed graphics in a folder, and I want the JS to load a random background graphic from that folder each time. </p>

    <p>My JS chooses a random number and then uses that to build the body's src attribute.</p>
    <pre><code>
const totalImages = 10;
const randomNumber = Math.floor(Math.random() * totalImages) + 1;
const imagePath = `../img/backgrounds/${randomNumber}.png`;
const imgElement = body.style.backgroundImage = `url('${imagePath}')`;
</code></pre>
    <p>That worked just fine. It blinks in a new image each time the page is loaded. Great.Now, to move on to build the fade-in. My thought was that using CSS transitions should be easy. I needed to set the transition on the body element's background image.
        Simple right.</p>
    <pre><code>
body{transition: background-image 3s ease-in;}
</code></pre>
    <p>I'll save you the webkit annotation.</p>
    <p><strong>That did not work.</strong></p>
    <p>I tried giving it a background-image initial setting, so the JS would override the background image using the local attribute.</p>
    <p><em>Nope, no fade in.</em></p>
    <p>The timing of loading the graphic and then animating that graphic using CSS transitions timing is funny. Hmm, an interesting problem to solve, but I don't have time for this.
        <strong>I needed a different solution</strong>, <em>but didn't want to throw away all that working JS</em>.</p>
    <h2> The Final Solution</h2>
    <p>The solution that worked. Instead of messing with the body, I chose to insert a DIV stretched across the entire viewport in the background of everything.</p>
    <h3>The HTML</h3>
    <pre><code>
// <div id="background-image"></div>
</code></pre>
    <h3>The CSS</h3>
    <pre><code>
#background-image {

    background-size: cover;
    background-position: center;
    position: fixed; /* Or absolute, to stay in the background */
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: -1; /* Place it behind all other content */
}</code></pre>
    <h3>The JS</h3>
    <p>My JavaScript now looks like this.</p>
    <pre><code>
const totalImages = 10;
const randomNumber = Math.floor(Math.random() * totalImages) + 1;
const imagePath = `../img/backgrounds/${randomNumber}.png`;
const imgElement = document.getElementById("background-image");
imgElement.style.backgroundImage = `url('${imagePath}')`;
gsap.from("#background-image", { opacity: 0, duration: 7 });
</code></pre>
    <p>It chooses a random number, like before. Now it inserts that random number into the src attribute of our div element.</p>
    <pre><code>
imgElement.style.backgroundImage = `url('${imagePath}')`;
</code></pre>
    <p>I then use GreenSock JS to animate the fade-in on that same element.</p>
    <pre><code>
gsap.from("#background-image", { opacity: 0, duration: 7 });
</code></pre>
    <p>So, by inserting this one div into the HTML of my document, it will slowly fade-in a new background image each time the page is loaded.</p><p>It works so great every time the page loads that adding it to my snippet library is absolutely a good idea.</p>
</section>
<section class="cel-100">
    <p>&nbsp;</p>
</section>